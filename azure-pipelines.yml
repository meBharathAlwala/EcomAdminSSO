trigger:
  branches:
    include:
      - Development

pr:
  branches:
    include:
      - Development

pool:
  name: 'Default'  # Your self-hosted Windows agent pool

stages:
- stage: BuildAndDeployDev   # dev
  displayName: 'Build and Deploy to DEV'
  condition: |
    or(
      eq(variables['Build.SourceBranch'], 'refs/heads/Development'),
      and(
        eq(variables['Build.Reason'], 'PullRequest'),
        eq(variables['System.PullRequest.TargetBranch'], 'refs/heads/Development')
      )
    )
  jobs:
  - job: BuildJob
    displayName: 'Build Angular Project'
    steps:
      - template: build.yml

  - job: DeployJob
    displayName: 'Deploy Angular Project to IIS'
    dependsOn: BuildJob
    condition: succeeded()
    steps:
      - template: deploy.yml
