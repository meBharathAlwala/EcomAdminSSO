- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      cd "$(Build.SourcesDirectory)"
      Write-Host "=== Installing Angular CLI globally ==="
      npm install -g @angular/cli

      Write-Host "=== Installing project dependencies ==="
      npm ci

      Write-Host "=== Building Angular project ==="
      npx ng build --configuration $(buildConfiguration)

      Write-Host "=== Verifying build output ==="
      if (Test-Path "dist/$(angularProjectName)/browser") {
        Write-Host "✅ Build output found in dist/$(angularProjectName)/browser"
        Get-ChildItem -Recurse dist/$(angularProjectName)/browser
      }
      else {
        Write-Host "❌ Build output not found"
        Get-ChildItem -Recurse dist
        exit 1
      }
  displayName: "Install Dependencies, Build & Verify Angular Project"
